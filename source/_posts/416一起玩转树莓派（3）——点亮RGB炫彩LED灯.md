---
title: ä¸€èµ·çŽ©è½¬æ ‘èŽ“æ´¾ï¼ˆ3ï¼‰â€”â€”ç‚¹äº®RGBç‚«å½©LEDç¯
date: 2021-07-10
categories: Linux
tags: []
---
# ä¸€èµ·çŽ©è½¬æ ‘èŽ“æ´¾ï¼ˆ3ï¼‰â€”â€”ç‚¹äº®RGBç‚«å½©LEDç¯

åœ¨é˜…è¯»æœ¬ç¯‡åšå®¢ä¹‹å‰ï¼Œå¦‚æžœä½ å¯¹æ ‘èŽ“æ´¾çš„GPIOè¿˜æ²¡æœ‰åŸºæœ¬çš„äº†è§£ï¼Œæˆ‘å»ºè®®ä½ å…ˆé˜…è¯»æœ¬ç³»åˆ—åšå®¢çš„ä¸Šä¸€ç¯‡ï¼Œå…³äºŽåŒè‰²LEDç¯å®žéªŒçš„ã€‚äº†è§£æ ‘èŽ“æ´¾GPIOçš„åŸºæœ¬ç”¨æ³•æ˜¯è¿›è¡Œæœ¬ç¯‡åšå®¢å®žéªŒçš„åŸºç¡€ã€‚ä¸Šç¯‡åšå®¢åœ°å€å¦‚ä¸‹ï¼š

[https://my.oschina.net/u/2340880/blog/5123429](https://my.oschina.net/u/2340880/blog/5123429)

çŽ°åœ¨ï¼Œå¦‚æžœä½ å·²ç»æˆåŠŸå®Œæˆè¿‡æ ‘èŽ“æ´¾åŒè‰²LEDç¯å®žéªŒï¼Œå¹¶ä¸”å¯¹æ·±å…¥æ ‘èŽ“æ´¾çŽ©æ³•æœ‰æ›´å¤šçš„å…´è¶£çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨è¿›ä¸€æ­¥ï¼Œå°è¯•ç‚¹äº®ä¸€ä¸ªæ›´åŠ ç»šä¸½çš„LEDç¯ï¼šRGB3è‰²LEDç¯ã€‚

## ä¸€ã€è®¤è¯†RGBä¸‰åŽŸè‰²LEDç¯å¹¶è¿žçº¿

é€šè¿‡å‰é¢çš„å®žéªŒï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ï¼ŒåŒè‰²çš„LEDç¯å†…éƒ¨å°è£…äº†çº¢ç»¿ä¸¤ä¸ªå‘å…‰äºŒæžç®¡ï¼Œå…¶æœ‰3ä¸ªå¼•è„šï¼Œå…¶ä¸­1ä¸ªå¼•è„šæ˜¯å…±ç”¨çš„(å…±é˜´æˆ–å…±é˜³)ï¼Œå¯¹äºŽå…±é˜´åž‹çš„åŒè‰²LEDç¯ï¼ŒæŽ§åˆ¶å¦å¤–ä¸¤ä¸ªå¼•è„šçš„é«˜ä½Žç”µå¹³æ¥åˆ†åˆ«ç‚¹äº®çº¢ç¯æˆ–ç»¿ç¯ã€‚å¯¹äºŽRGB3è‰²LEDç¯ä¹Ÿç±»ä¼¼ï¼Œåªæ˜¯å…¶å†…éƒ¨å°è£…äº†3ä¸ªå‘å…‰äºŒæžç®¡ï¼Œåˆ†åˆ«å¯ä»¥å‘å‡ºçº¢å…‰ï¼Œç»¿å…‰å’Œè“å…‰ã€‚å…¶æœ‰4ä¸ªå¼•è„šï¼Œ1ä¸ªå¼•è„šå…±ç”¨å’Œ3ä¸ªæŽ§åˆ¶å‘å…‰äºŒæžç®¡çš„å¼•è„šã€‚

æœ¬æ¬¡å®žéªŒï¼Œæˆ‘ä»¬ä¾ç„¶é‡‡ç”¨å…±é˜´åž‹çš„RGB3è‰²LEDç¯ï¼Œå…ƒä»¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://oscimg.oschina.net/oscnet/up-49ede8533183d038436f5fa1c6ba00a9b7e.JPEG)

å…±é˜´åž‹çš„LEDç¯ï¼ŒGNDå¼•è„šæ˜¯å…¶å…¬å…±çš„é˜´æžï¼ŒæŽ¥çº¿çš„æ—¶å€™æˆ‘ä»¬éœ€è¦å°†æ­¤å¼•è„šæŽ¥åœ°ï¼Œå¦å¤–3ä¸ªå¼•è„šåˆ†åˆ«æŽ¥3ä¸ªGPIOæ¥æŽ§åˆ¶äº®ç¯ã€‚ä¸‹é¢ä¸¤ç§å›¾ï¼Œéžå¸¸ç›´è§‚çš„æ¼”ç¤ºäº†æ­¤LEDç¯çš„å·¥ä½œåŽŸç†ï¼š

![](https://oscimg.oschina.net/oscnet/up-b1304b74a0ad7187e624b765bc27563c4fb.png)![](https://oscimg.oschina.net/oscnet/up-e89603ce34e6093a564a8998b4e095947ac.png)

åœ¨å°†LEDç¯è¿žæŽ¥åˆ°æ ‘èŽ“æ´¾ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦é¢„å®šå‡ ä¸ªè¦ç”¨çš„GPIOå¼•è„šï¼Œä¹‹åŽæˆ‘ä»¬åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œä¾ç„¶é‡‡ç”¨ç‰©ç†ç¼–ç ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆç¡®å®šè¦ä½¿ç”¨çš„GPIOå¼•è„šçš„BCMç¼–ç ä¸‹çš„GPIO18ï¼ŒGPIO19å’ŒGPIO20ï¼Œé€šå¸¸æŸ¥çœ‹å¼•è„šç¼–ç å¯¹åº”å›¾ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å…¶æ‰€å¯¹åº”çš„ç‰©ç†å¼•è„šåˆ†åˆ«ä¸º12ï¼Œ24å’Œ28ã€‚å¦‚æžœä¸ä½¿ç”¨æ‰©å±•æ¿ï¼Œç›´æŽ¥å°†åŽŸä»¶ä¸Šçš„å¯¹åº”å¼•è„šè¿žæŽ¥åˆ°æ ‘èŽ“æ´¾çš„è¿™äº›ç‰©ç†å¼•è„šä¸Šå³å¯ï¼Œå¦‚æžœä½¿ç”¨çš„æ˜¯BCMç¼–ç çš„æ‰©å±•æ¿ï¼Œåˆ™æˆ‘ä»¬åœ¨è¿žçº¿æ—¶æ— éœ€å…³å¿ƒè¿™äº›ç‰©ç†å¼•è„šï¼Œç›´æŽ¥è¿žæŽ¥å³å¯ï¼Œå¦‚ä¸‹ï¼š

![](https://oscimg.oschina.net/oscnet/up-e0348c7f0ae163621b3bb6b00b44e9053ec.JPEG)

å¥½äº†ï¼ŒçŽ°åœ¨æˆ‘ä»¬å·²ç»å®Œæˆäº†åŸºæœ¬çš„è¿žçº¿å·¥ä½œã€‚

## äºŒã€ä¸‰åŽŸè‰²ä¸Žè„‰å†²å®½åº¦è°ƒåˆ¶

ä¸‰åŽŸè‰²æœ¬æŒ‡è‰²å½©ä¸­ä¸èƒ½å†åˆ†è§£çš„ä¸‰ç§åŸºæœ¬é¢œè‰²ï¼Œåœ¨å…‰å­¦ä¸Šï¼Œçº¢ã€ç»¿ã€è“ä¸ºæœ€åŸºæœ¬çš„ä¸‰åŽŸè‰²ã€‚ä¸‰åŽŸè‰²ç»è¿‡æ··åˆåŽï¼Œå¯ä»¥ç»„æˆå„å¼å„æ ·çš„é¢œè‰²ã€‚ä¾‹å¦‚å°†ä¸‰åŽŸè‰²ç­‰æ¯”æ··åˆåŽå°†èƒ½ç»„æˆç™½è‰²ï¼Œå°†çº¢è‰²å’Œç»¿è‰²ç»„åˆåŽä¼šç”Ÿæˆé»„è‰²ï¼Œå°†çº¢è‰²å’Œè“è‰²æ··åˆåŽä¼šå¾—åˆ°ç´«è‰²ç­‰ç­‰ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://oscimg.oschina.net/oscnet/up-e6794fc6def4e70f6090ccb7464147ed4f7.png)

å› æ­¤ï¼Œä»ŽåŽŸç†ä¸Šè¯´ï¼Œæˆ‘ä»¬åªè¦å¯ä»¥æŽ§åˆ¶RGBç¯ä¸‰ç§é¢œè‰²çš„æ˜¾ç¤ºäº®åº¦ï¼Œå°±å¯ä»¥è®©LEDç¯è°ƒåˆ¶å‡ºå„ç§é¢œè‰²ã€‚æŽ§åˆ¶LEDç­‰ä¸­å„ä¸ªå‘å…‰äºŒæžç®¡çš„äº®å’Œç­éžå¸¸ç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦å‘å…¶åŠ é«˜ç”µå¹³æˆ–ä½Žç”µå¹³å³å¯ï¼Œé‚£ä¹ˆå¦‚ä½•æŽ§åˆ¶å‘å…‰äºŒæžç®¡çš„äº®åº¦å‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ°å¦å¤–ä¸€ç§ç”µæµæŽ§åˆ¶æŠ€æœ¯ï¼šPWMè„‰å†²å®½åº¦è°ƒåˆ¶ã€‚

è„‰å†²å®½åº¦è°ƒåˆ¶(PWM)æ˜¯ä¸€ç§æ¨¡æ‹ŸæŽ§åˆ¶æ–¹å¼ï¼Œå…¶é€šè¿‡æŽ§åˆ¶è„‰å†²ç”µåŽ‹ä¸­é«˜ç”µåŽ‹çš„å ç©ºæ¯”æ¥æŽ§åˆ¶æµè¿‡å…ƒä»¶çš„ç”µæµå¤§å°ã€‚PWMæŠ€æœ¯ä¸­æœ‰ä¸¤ä¸ªéžå¸¸é‡è¦çš„å‚æ•°ï¼šé¢‘çŽ‡ä¸Žå ç©ºæ¯”ã€‚é¢‘çŽ‡ç”¨æ¥æŽ§åˆ¶è„‰å†²ä¿¡å·çš„å‘¨æœŸï¼Œå¦‚æžœé¢‘çŽ‡è¿‡ä½Žï¼Œåœ¨æŽ§åˆ¶LEDç¯çš„æ—¶å€™ï¼Œç¯å°±ä¼šè¿›è¡Œé—ªçƒï¼Œå½“é¢‘çŽ‡è¶³å¤Ÿé«˜ï¼Œäººçœ¼å·²æ— æ³•åˆ†è¾¨å‡ºå…¶é—ªçƒï¼Œçœ‹ä¸Šèµ·LEDç¯å°±æ˜¯å¸¸äº®çš„ã€‚å ç©ºæ¯”æŒ‡çš„æ˜¯åœ¨è¾“å‡ºçš„è„‰å†²ä¿¡å·ä¸­ï¼Œé«˜ç”µå¹³ä¿æŒçš„æ—¶é—´ä¸Žè¯¥è„‰å†²ä¿¡å·çš„å‘¨æœŸæ—¶é—´ä¹‹æ¯”ã€‚ä¾‹å¦‚ï¼Œå‡è®¾è®¾ç½®å‘¨æœŸä¸º100Hzï¼Œåˆ™å…¶å‘¨æœŸæ—¶é—´ä¸º10msï¼Œå¦‚æžœè®¾ç½®çš„å ç©ºæ¯”ä¸º20%ï¼Œåˆ™å½“å‰å‘¨æœŸä¸­ï¼Œé«˜ç”µå¹³çš„å æ¯”æ—¶é—´ä¸º2msã€‚

Pythonçš„GPIOåº“ä¸­æä¾›äº†PWMæŽ§åˆ¶æŽ¥å£ï¼Œä½¿ç”¨ä¹Ÿéžå¸¸ç®€å•ï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹æ³•å¯ä»¥èŽ·å–æŸä¸ªå¼•è„šçš„PWMå®žä¾‹ï¼š

```python
p = GPIO.PWM(channel, frequency)

```

å…¶ä¸­ï¼Œchannelå‚æ•°ä¸ºå¼•è„šç¼–ç ï¼Œfrequencyå‚æ•°ä¸ºè®¾ç½®çš„PWMé¢‘çŽ‡ã€‚ä¸‹é¢æ–¹æ³•ç”¨æ¥å¼€å¯PWMè„‰å†²ï¼š

```python
p.start(dc)

```

å…¶ä¸­ï¼Œdcå‚æ•°è®¾ç½®è„‰å†²çš„é«˜ç”µå¹³å ç©ºæ¯”ï¼Œå–å€¼èŒƒå›´ä¸º0-100ã€‚

é€šè¿‡ä¸‹é¢çš„æ–¹æ³•å¯ä»¥å¯¹PWMè„‰å†²é¢‘çŽ‡å’Œå ç©ºæ¯”è¿›è¡Œä¿®æ”¹ï¼š

```objectivec
p.ChangeFrequency(freq) 
p.ChangeDutyCycle(dc)

```

éœ€è¦ç»“æŸPWMè„‰å†²è°ƒåˆ¶æ—¶ï¼Œå¯ä»¥è°ƒç”¨å¦‚ä¸‹æ–¹æ³•ï¼š

```python
p.stop()

```

## ä¸‰ã€ç‚¹äº®ç‚«å½©çš„ä¸‰å½©LEDç¯

çŽ°åœ¨ï¼Œæˆ‘ä»¬å·²ç»åšå¥½äº†æ‰€æœ‰å‡†å¤‡å·¥ä½œï¼Œå¯ä»¥å¼€å§‹ç¼–ç äº†ã€‚æˆ‘ä»¬è¦å®žçŽ°è¿™æ ·ä¸€ä¸ªåŠŸèƒ½ï¼Œå½“ç¨‹åºè¿è¡Œæ—¶ï¼Œå…ˆæŽ§åˆ¶LEDç¯çš„çº¢ç¯ï¼Œç»¿ç¯ï¼Œé›è‰²ç¯åˆ†åˆ«äº®2ç§’ï¼Œä¹‹åŽé€šè¿‡è„‰å†²æ··åˆï¼Œè®©LEDç¯è¿›è¡Œå„ç§é¢œè‰²çš„ç‚«å½©é—ªçƒï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š

```python
#coding:utf-8

# å¯¼å…¥GPIOæŽ§åˆ¶è–„å—
import RPi.GPIO as GPIO
# å¯¼å…¥timeæ¨¡å—
import time
# å¯¼å…¥ç³»ç»Ÿæ¨¡å—
import sys

# å®šä¹‰å¼•è„š(ç‰©ç†å¼•è„š)
R,G,B = 12,35,38
# è®¾ç½®ä½¿ç”¨çš„å¼•è„šç¼–ç æ¨¡å¼
GPIO.setmode(GPIO.BOARD)

# å¯¹è¦ä½¿ç”¨çš„å¼•è„šè¿›è¡Œåˆå§‹åŒ–
GPIO.setup(R,GPIO.OUT)
GPIO.setup(G,GPIO.OUT)
GPIO.setup(B,GPIO.OUT)

# ä½¿ç”¨PWMè„‰å†²å®½åº¦è°ƒåˆ¶
pR = GPIO.PWM(R, 60)
pG = GPIO.PWM(G, 60)
pB = GPIO.PWM(B, 60)

# å¼€å¯è„‰å†²ï¼Œé»˜è®¤çš„å ç©ºæ¯”ä¸º0ï¼Œç¯ä¸äº®
pR.start(0)
pG.start(0)
pB.start(0)

# åˆå§‹æ—¶ï¼Œå„ç§é¢œè‰²ç‚¹äº®2ç§’
# çº¢ç¯å…ˆäº®2ç§’
pR.ChangeDutyCycle(100)
pG.ChangeDutyCycle(0)
pB.ChangeDutyCycle(0)
time.sleep(2)

# æ›¿æ¢ä¸ºç»¿ç¯äº®2ç§’
pR.ChangeDutyCycle(0)
pG.ChangeDutyCycle(100)
pB.ChangeDutyCycle(0)
time.sleep(2)

# æ›¿æ¢ä¸ºé›è‰²ç¯äº®2ç§’
pR.ChangeDutyCycle(0)
pG.ChangeDutyCycle(0)
pB.ChangeDutyCycle(100)
time.sleep(2)

# å®šä¹‰è¦é—ªçƒçš„æ—¶é—´ è¿™é‡Œå®šä¹‰ä¸º10ç§’
endTime = 100
current = 0

# å¼€å§‹è¿›è¡Œç‚«å½©é—ªçƒ
while True:
    # é€šè¿‡å ç©ºæ¯”æŽ§åˆ¶çº¢è‰²çš„å æ¯”
    for r in range(0, 101, 10):
        pR.ChangeDutyCycle(r)
        # é€šè¿‡å ç©ºæ¯”æŽ§åˆ¶ç»¿è‰²çš„å æ¯”
        for g in range(0, 101, 10):
            pG.ChangeDutyCycle(g)
            # ç©ºé€šè¿‡å ç©ºæ¯”æŽ§åˆ¶è“è‰²çš„å æ¯”
            for b in range(0, 101, 10):
                pB.ChangeDutyCycle(b)
                time.sleep(0.1)
                current += 1
                # ç»“æŸç¨‹åº
                if (current > endTime):
                    pR.stop()
                    pG.stop()
                    pB.stop()
                    GPIO.cleanup()
                    sys.exit(0)

```

åœ¨æ ‘èŽ“æ´¾ä¸Šè¿è¡Œæ­¤ç¨‹åºï¼Œæ³¨æ„ï¼å°å¿ƒä¸è¦è¢«å¤ªäº®çš„LEDé—ªåˆ°äº†çœ¼ç›ðŸ˜ã€‚

> ä¸“æ³¨æŠ€æœ¯ï¼Œæ‡‚çš„çƒ­çˆ±ï¼Œæ„¿æ„åˆ†äº«ï¼Œåšä¸ªæœ‹å‹
> 
> QQï¼š316045346
