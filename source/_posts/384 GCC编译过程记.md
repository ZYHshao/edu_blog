---
title: GCC编译过程记
date: 2018-10-16
categories: 编程珠玑
tags: []
---
## GCC编译过程记

### 一、引言

      对于编程工作者来说，GCC是一个熟悉的名字，它的全称是“GNU Compiler Collection”。GCC是一组编译器集合，目前其支持C、C++、Objective-C、Objective-C++、Go和RBIG语言的编译。本篇博客主要总结使用GCC进行代码编译的方法以及从源文件生成可执行文件的整个过程。

    GCC完整的编译过程分为4个阶段，分别为预处理、编译、装载和链接。经过完整的4部处理后，GCC会将源文件编译成可执行文件进行输出，但是很多时候，我们进行调用时并不需要每一个过程都单独调用，可以使用组合命令来让GCC帮我们处理完成这些工作。

### 二、GCC编译的输出参数

    由于GCC是一组编译器集合，因此输入的文件后缀名决定了GCC的编译方式，下面列出了常见的文件后缀名对应的编译方式：

| 文件后缀名  | 编译方式 |
| .c | C语言源代码，并且需要进行预处理 |
| .i | 已经预处理完成后的C语言源代码 |
| .ii | 已经预处理完成后的C++源代码 |
| .m | Objective-C源代码，并且必须进行libobjc库的链接 |
| .mi | 已经预处理完成后的Objective-C源代码 |
| .M或.mm | Objective-C++源代码，并且必须进行libobjc库的链接 |
| .mii | 已经预处理完成后的Objective-C++源代码 |
| .h | C,C++,Objective-C的头文件，会被处理进预编译头 |
| .cc , .cp , .cxx , .cpp , .CPP , .c++ , .C | C++语言源文件，需要进行预编译处理 |
| .f , .for , .ftn | 已经预处理完成后的Fortran语言源文件 |
| .F , .FOR , .fpp , .FPP , .FTN | Fortran语言源文件，需要进行预编译处理 |
| .go | Go语言源文件 |

下面以一个简单的C语言源文件来作为示例文件进行GCC的编译演示，首先编写一个简单的C程序如下，将文件名命名为a.c：

```cpp
#include <stdio.h>
int main(int argc, char const *argv[])
{
    printf("%s\n","Hello");
    return 0;
}
```

#### ·预编译处理

    使用 -E 参数设置GCC只进行预编译处理，例如对上面的a.c源文件执行如下的GCC命令：

```
gcc a.c -E > a.i
```

需要注意，GCC会将编译后的内容输出到a.i这个文件中，执行命令后，打开a.i文件，你会发现一个简单的C源文件被预处理成了500多行代码，你可以尝试在源文件中添加宏定义，预处理后所有的宏定义都被直接替换了。

    使用 -S 参数设置GCC进行编译功能，可以将预处理后的文件编译为汇编源代码，例如：

```
gcc a.i -S > a.S
```

.S为后缀名的文件为汇编源文件，-S编译是高级语言向低级语言转换的过程。

    使用 -c 参数设置GCC进行编译，可以将汇编后的汇编源文件编译成机器代码。例如：

```
gcc a.i -c > a.o
```

.o后缀名的文件一般我们就没有办法读懂了，其是机器码。-c编译是编程语言向机器语言转换的过程。

    除了上面提到的几个参数外，可以使用-o参数直接生成目标文件，这个参数会根据输入文件的后缀名进行处理，直接生成可执行文件，例如：

```
gcc a.o -o a.out
```

其实使用.c为后缀名的C语言源文件也可以直接使用-o参数生成可执行文件，此时GCC会聚合前面的预处理，编译，连接等过程。.out为后缀名的文件是可执行文件，在终端可以直接执行，如下：

![](https://oscimg.oschina.net/oscnet/aea884445475baa794bd235e518fe4c9bfe.jpg)
