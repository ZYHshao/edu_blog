<!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="ç²å°‘çš„æŠ€æœ¯åšå®¢">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="http://huishao.cc">
    <!--SEO-->

<meta name="description" content="ç²å°‘çš„æŠ€æœ¯åšå®¢">



<meta name="keywords" content="ç²å°‘">



<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">
    <!--Title-->


<title>ä½¿ç”¨Pythonç¼–å†™iOSåŸç”Ÿåº”ç”¨çš„æ¡†æ¶è®¾è®¡æ€è€ƒ(é¦–ç¯‡) | ç²å°‘çš„æŠ€æœ¯åšå®¢</title>


    <link rel="alternate" href="/atom.xml" title="ç²å°‘çš„æŠ€æœ¯åšå®¢" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    





    
</head>

</html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">ä½ ä½¿ç”¨çš„æµè§ˆå™¨ç‰ˆæœ¬è¿‡ä½ï¼Œä¸ºäº†ä½ æ›´å¥½çš„é˜…è¯»ä½“éªŒï¼Œè¯·æ›´æ–°æµè§ˆå™¨çš„ç‰ˆæœ¬æˆ–è€…ä½¿ç”¨å…¶ä»–ç°ä»£æµè§ˆå™¨ï¼Œæ¯”å¦‚Chromeã€Firefoxã€Safariç­‰ã€‚</div>
<![endif]-->

<body>
    <header class="main-header"  style="background-image:url(http://7xpw2b.com1.z0.glb.clouddn.com/hexo-sinppet/img/banner.png)"  >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title='ç²å°‘'>
            <img src="/img/avatar.jpg" alt="logoå¤´åƒ" class="img-responsive center-block">
        </a>
        <div class="branding">
        	<!--<h2 class="text-hide">Snippetä¸»é¢˜,ä»æœªå¦‚æ­¤ç®€å•æœ‰è¶£</h2>-->
            
                <h2> å­¦å¦‚é€†æ°´è¡ŒèˆŸ </h2>
            
    	</div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="http://huishao.cc">ç²å°‘çš„æŠ€æœ¯åšå®¢</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>ä¸»é¡µ</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/archives/"><i class="fa "></i>å½’æ¡£</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="ä½¿ç”¨Pythonç¼–å†™iOSåŸç”Ÿåº”ç”¨çš„æ¡†æ¶è®¾è®¡æ€è€ƒ(é¦–ç¯‡)">
            
	            ä½¿ç”¨Pythonç¼–å†™iOSåŸç”Ÿåº”ç”¨çš„æ¡†æ¶è®¾è®¡æ€è€ƒ(é¦–ç¯‡)
            
        </h1>
        <div class="post-meta">
    
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <a href="/categories/ä¸‡è¨€å½’å®—">
            ä¸‡è¨€å½’å®—
        </a>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
                
            
        </span>
    </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2020/04/30</span>
        </span>
    
</div>

            
            
    </div>
    
    <div class="post-body post-content">
        <h1 id="ä½¿ç”¨Pythonç¼–å†™iOSåŸç”Ÿåº”ç”¨çš„æ¡†æ¶è®¾è®¡æ€è€ƒ-é¦–ç¯‡"><a href="#ä½¿ç”¨Pythonç¼–å†™iOSåŸç”Ÿåº”ç”¨çš„æ¡†æ¶è®¾è®¡æ€è€ƒ-é¦–ç¯‡" class="headerlink" title="ä½¿ç”¨Pythonç¼–å†™iOSåŸç”Ÿåº”ç”¨çš„æ¡†æ¶è®¾è®¡æ€è€ƒ(é¦–ç¯‡)"></a>ä½¿ç”¨Pythonç¼–å†™iOSåŸç”Ÿåº”ç”¨çš„æ¡†æ¶è®¾è®¡æ€è€ƒ(é¦–ç¯‡)</h1><h2 id="ä¸€ã€å¼•å­"><a href="#ä¸€ã€å¼•å­" class="headerlink" title="ä¸€ã€å¼•å­"></a>ä¸€ã€å¼•å­</h2><pre><code>ä½¿ç”¨Pythonç¼–å†™iOSåŸç”Ÿåº”ç”¨ï¼Œä¸ºä½•æœ‰è¿™æ ·çš„æƒ³æ³•ï¼Œå…¶å®æœ¬æ¥æ˜¯æºäºå¯¹JSç±»çš„è·¨å¹³å°æ¡†æ¶çš„å­¦ä¹ ã€‚ç†Ÿæ‚‰åŸç”Ÿå¼€å‘çš„åŒå­¦ä»¬éƒ½çŸ¥é“ï¼Œå¯¹äºå¯è·¨å¹³å°çš„åŸç”Ÿæ¡†æ¶ï¼Œä½¿ç”¨JSå®ç°çš„å äº†å¤§åŠï¼Œå…¶åŸå› æ˜¯ç”±äºAppleå†…ç½®äº†JavaScriptCoreè¿™æ ·ä¸€ä¸ªJSå¼•æ“ï¼Œä½¿å¾—JavaScriptä¸Objective-Cçš„äº¤äº’å˜å¾—éå¸¸å®¹æ˜“ï¼Œèƒ½å¤Ÿäº¤äº’ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®¹æ˜“çš„ç¼–å†™å‡ºå„ç§å„æ ·çš„æ¡¥æ¥ä¸ºJSç«¯æä¾›åŸç”ŸåŠŸèƒ½ï¼Œéšç€åŸç”Ÿç«¯æ¡¥çš„å…¨é¢æ”¯æŒå’ŒJSç«¯ç»„ä»¶çš„ä¸°å¯Œï¼Œä¸€ä¸ªå®Œæ•´çš„çŸ¿å¹³å°æ¡†æ¶å°±è¯ç”Ÿäº†ã€‚è™½è¯´è¿™æ˜¯ä¸€ä¸ªåºå¤§çš„å·¥ç¨‹ï¼Œä½†æ˜¯å®ç°æ€è·¯å¹¶ä¸æ·±å¥¥ï¼Œä¹‹å‰ä¹Ÿæœ‰åšå®¢ä¹Ÿæœ‰ä»‹ç»ï¼š
</code></pre><p><a href="https://my.oschina.net/u/2340880/blog/856321" target="_blank" rel="noopener">https://my.oschina.net/u/2340880/blog/856321</a></p>
<p>æœ‰äº†JavaScriptæ¡†æ¶å®ç°æ€è·¯çš„åŸºç¡€ï¼Œé‚£ä¹ˆä¸å…å°±å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œå…¶å®åœ¨è¯­è¨€å±‚é¢ï¼Œè¯­è¨€å¯ä»¥åšçš„äº‹æƒ…éƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œåªè¦æœ‰å¯¹åº”çš„å¼•æ“å¯ç”¨ï¼Œé‚£ä¹ˆåŸåˆ™ä¸Šè¯´ï¼Œä»»ä½•è¯­è¨€éƒ½å¯ä»¥ç¼–å†™iOSåº”ç”¨ç¨‹åºï¼Œåªæœ‰éš¾ä»¥ä¸æ–¹ä¾¿ä¸å¦çš„å·®åˆ«ã€‚å¯¹äºPythonæ¥è¯´ï¼Œå…¶çš„ç¡®æœ‰iOSç‰ˆæœ¬çš„è§£é‡Šå™¨å¯ç”¨ã€‚</p>
<h2 id="äºŒã€åœ¨iOSå¹³å°ä½¿ç”¨Pythonè§£é‡Šå™¨"><a href="#äºŒã€åœ¨iOSå¹³å°ä½¿ç”¨Pythonè§£é‡Šå™¨" class="headerlink" title="äºŒã€åœ¨iOSå¹³å°ä½¿ç”¨Pythonè§£é‡Šå™¨"></a>äºŒã€åœ¨iOSå¹³å°ä½¿ç”¨Pythonè§£é‡Šå™¨</h2><pre><code>Githubä¸Šæœ‰å¾ˆå¤šæœ‰è¶£çš„é¡¹ç›®ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªé¡¹ç›®å¯ä»¥å°†Pythonæºç ç¼–è¯‘æˆå¯ä»¥åœ¨iOSå¹³å°è¿è¡Œçš„Frameworkï¼Œå…¶åœ°å€å¦‚ä¸‹ï¼š
</code></pre><p><a href="https://github.com/beeware/Python-Apple-support" target="_blank" rel="noopener">https://github.com/beeware/Python-Apple-support</a></p>
<p>æœ‰äº†è¿™ä¸ªå·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä»»æ„ç‰ˆæœ¬çš„Pythonæ¥å°†å…¶æ‰“åŒ…æˆFrameworkåœ¨iOSå¹³å°è¿è¡Œï¼Œå½“ç„¶å¦‚æœä½ å¯¹ç‰ˆæœ¬æ²¡æœ‰ç‰¹æ®Šçš„è¦æ±‚ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥ä»ä¸‹é¢çš„åœ°å€ä¸‹è½½å·²ç»æ‰“åŒ…å¥½çš„Framewokä½¿ç”¨ï¼š</p>
<p><a href="https://github.com/pybee/Python-iOS-support/releases" target="_blank" rel="noopener">https://github.com/pybee/Python-iOS-support/releases</a></p>
<p>ä¸‹è½½å®Œæˆåï¼Œä¼šå¾—åˆ°ä¸¤ä¸ªFrameworkï¼Œå°†ä»–ä»¬æ·»åŠ è¿›å·¥ç¨‹ï¼Œå¹¶è¿›è¡Œé“¾æ¥ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://oscimg.oschina.net/oscnet/up-0df0eacfe4ed51435849bcbc1047b4d7caf.png" alt></p>
<p>éœ€è¦æ³¨æ„ï¼Œå¯¹äºPython.frameworkè¦æ›´ç‰¹æ®Šä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶æ‹·è´è¿›å·¥ç¨‹çš„Bundleä¸­ï¼Œä»¥ä¾¿åç»­ä½¿ç”¨ã€‚</p>
<h2 id="ä¸‰ã€ç¼–å†™æ¡¥æ¥æ–‡ä»¶"><a href="#ä¸‰ã€ç¼–å†™æ¡¥æ¥æ–‡ä»¶" class="headerlink" title="ä¸‰ã€ç¼–å†™æ¡¥æ¥æ–‡ä»¶"></a>ä¸‰ã€ç¼–å†™æ¡¥æ¥æ–‡ä»¶</h2><pre><code>è¿™éƒ¨åˆ†ä¸»è¦æœ‰Objective-Cå®ç°ï¼Œç”¨æ¥å¯åŠ¨Pythonå¼•æ“ï¼ŒåŠ è½½Pythonä¸šåŠ¡ä»£ç çš„å…¥å£æ–‡ä»¶ï¼Œåšå„ç§åŸç”Ÿç»„ä»¶ä¸Pythonç»„ä»¶çš„æ¡¥æ¥ç­‰ã€‚é¦–å…ˆç¼–å†™ä¸€ä¸ªå¤´æ–‡ä»¶ç”¨æ¥è¿›è¡Œé™æ€å˜é‡å’Œå®çš„å®šä¹‰ï¼Œå¦‚ä¸‹ï¼š
</code></pre><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  BrdgeDefine.h</span></span><br><span class="line"><span class="comment">//  PyNativeDemo</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by ç²å°‘ on 2020/4/30.</span></span><br><span class="line"><span class="comment">//  Copyright Â© 2020 jaki. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#ifndef BrdgeDefine_h</span></span><br><span class="line"><span class="meta">#define BrdgeDefine_h</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Python/Python.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#define INTERFACE_INSTANCE + (instancetype)sharedInstance;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#define IMPLEMENTATION_INSTANCE             \</span></span><br><span class="line">+ (<span class="keyword">instancetype</span>)sharedInstance &#123;            \</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">id</span> instance = <span class="literal">nil</span>;               \</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;       \</span><br><span class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;            \</span><br><span class="line">        <span class="keyword">if</span> (!instance) &#123;                    \</span><br><span class="line">            instance = [[<span class="keyword">self</span> alloc] init]; \</span><br><span class="line">        &#125;                                   \</span><br><span class="line">    &#125;);                                     \</span><br><span class="line">    <span class="keyword">return</span> instance;                        \</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#define SELF_INSTANCE [self.class sharedInstance]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#endif /* BrdgeDefine_h */</span></span><br></pre></td></tr></table></figure>
<p>ç¼–å†™Pythonæ¡¥çš„å¼•æ“ç±»ï¼Œå¦‚ä¸‹ï¼š</p>
<p>BridgeEnigine.h:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"BrdgeDefine.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_BEGIN</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BridgeEngine</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">INTERFACE_INSTANCE</span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">UIViewController</span> *)setupEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_END</span></span><br></pre></td></tr></table></figure>
<p>BridgeEnigine.m:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"BridgeEngine.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"DisplayRender.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"PythonRun.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BridgeEngine</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">BridgeEngine</span></span></span><br><span class="line"></span><br><span class="line">IMPLEMENTATION_INSTANCE</span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">UIViewController</span> *)setupEngine &#123;</span><br><span class="line">    [SELF_INSTANCE startEngine];</span><br><span class="line">    [SELF_INSTANCE loadLib];</span><br><span class="line">    [SELF_INSTANCE runMain];</span><br><span class="line">    <span class="keyword">return</span> [SELF_INSTANCE renderRoot];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)startEngine &#123;</span><br><span class="line">    <span class="built_in">NSString</span>* frameworkPath = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@/Resources"</span>,[SELF_INSTANCE p_pythonFrameworkPath]];</span><br><span class="line">    <span class="keyword">wchar_t</span> *pythonHome = [SELF_INSTANCE stingTowWchar_t:frameworkPath];</span><br><span class="line">    Py_SetPythonHome(pythonHome);</span><br><span class="line">    Py_Initialize();</span><br><span class="line">    PyEval_InitThreads();</span><br><span class="line">    <span class="keyword">if</span> (Py_IsInitialized()) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"ğŸ˜„åˆå§‹åŒ–ç¯å¢ƒæˆåŠŸğŸ˜„"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"ğŸ˜¢Pythonåˆå§‹åŒ–ç¯å¢ƒå¤±è´¥ğŸ˜¢"</span>);</span><br><span class="line">        exit(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)loadLib &#123;</span><br><span class="line">    <span class="built_in">NSString</span> *path = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"import sys\nsys.path.append(\"%@\")"</span>,[[<span class="built_in">NSBundle</span> mainBundle] resourcePath]];</span><br><span class="line">    PyRun_SimpleString([path UTF8String]);</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"ğŸ˜„libåŠ è½½æˆåŠŸğŸ˜„"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)runMain &#123;</span><br><span class="line">    PyObject * pModule = PyImport_ImportModule([<span class="string">@"main"</span> UTF8String]);<span class="comment">//å¯¼å…¥æ¨¡å—</span></span><br><span class="line">    [PythonRun sharedInstance].mainItemDic = PyModule_GetDict(pModule);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIViewController</span> *)renderRoot &#123;</span><br><span class="line">    <span class="keyword">return</span> [[DisplayRender sharedInstance] renderRoot:<span class="string">@"Main"</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">wchar_t</span> *)stingTowWchar_t:(<span class="built_in">NSString</span>*)string &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">wchar_t</span>*)[string cStringUsingEncoding:<span class="built_in">NSUTF32StringEncoding</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span>*)p_pythonFrameworkPath&#123;</span><br><span class="line">    <span class="built_in">NSString</span>* path = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"Python"</span> ofType:<span class="string">@"framework"</span>];</span><br><span class="line">    <span class="keyword">return</span> path;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)dealloc &#123;</span><br><span class="line">    Py_Finalize();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­æœ‰ä½¿ç”¨åˆ°DisplayRenderï¼Œç”±äºPythonæ²¡æœ‰åŠæ³•ä¸»åŠ¨è°ƒç”¨åŸç”Ÿï¼Œåˆæ­¥è®¾æƒ³ï¼Œè®©è¿™ä¸ªç±»é€šè¿‡å¸§åˆ·æ–°æ¥è´Ÿè´£å¯¹ç•Œé¢çš„æ¸²æŸ“ç»´æŠ¤ï¼Œç¼–ç å¦‚ä¸‹ï¼š</p>
<p>DisplayRender.h:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"BrdgeDefine.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_BEGIN</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">DisplayRender</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">INTERFACE_INSTANCE</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIViewController</span> *)renderRoot:(<span class="built_in">NSString</span> *)main;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_END</span></span><br></pre></td></tr></table></figure>
<p>DisplayRender.m:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"DisplayRender.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"PythonRun.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"BridgeColor.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewMaker.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">DisplayRender</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UIViewController</span> *rootController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSMutableArray</span>&lt;<span class="built_in">UIView</span> *&gt; *subViews;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">DisplayRender</span></span></span><br><span class="line"></span><br><span class="line">IMPLEMENTATION_INSTANCE</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIViewController</span> *)renderRoot:(<span class="built_in">NSString</span> *)main &#123;</span><br><span class="line">    <span class="built_in">NSDictionary</span> *root = [[PythonRun sharedInstance] run:[main UTF8String] method:[<span class="string">@"render_main_view"</span> UTF8String]];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"AppLaunchFinishğŸ™…â€â™€ï¸"</span>);</span><br><span class="line">    [<span class="keyword">self</span> renderController:root];</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.rootController;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)renderController:(<span class="built_in">NSDictionary</span> *)info &#123;</span><br><span class="line">    [<span class="keyword">self</span>.subViews enumerateObjectsUsingBlock:^(<span class="built_in">UIView</span> *  _Nonnull obj, <span class="built_in">NSUInteger</span> idx, <span class="built_in">BOOL</span> * _Nonnull stop) &#123;</span><br><span class="line">        [obj removeFromSuperview];</span><br><span class="line">    &#125;];</span><br><span class="line">    [<span class="keyword">self</span>.subViews removeAllObjects];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *bg = [info objectForKey:<span class="string">@"color"</span>];</span><br><span class="line">    <span class="keyword">self</span>.rootController.view.backgroundColor = [BridgeColor colorWith:bg];</span><br><span class="line">    <span class="built_in">NSArray</span> *views = [info objectForKey:<span class="string">@"subViews"</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSUInteger</span> i = <span class="number">0</span>; i &lt; views.count; i++) &#123;</span><br><span class="line">        <span class="keyword">id</span> view = [ViewMaker makerView:[views[i] objectForKey:<span class="string">@"name"</span>]];</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">NSString</span> *key <span class="keyword">in</span> [views[i] allKeys]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (![key isEqualToString:<span class="string">@"name"</span>]) &#123;</span><br><span class="line">                [view setValue:[views[i] objectForKey:key] forKey:key];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        [<span class="keyword">self</span>.subViews addObject:view];</span><br><span class="line">        [<span class="keyword">self</span>.rootController.view addSubview:view];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIViewController</span> *)rootController &#123;</span><br><span class="line">    <span class="keyword">if</span> (!_rootController) &#123;</span><br><span class="line">        _rootController = [[<span class="built_in">UIViewController</span> alloc] init];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _rootController;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>PythonRunæ˜¯ä¸€ä¸ªå·¥å…·ç±»ï¼Œèµ·æ¥è°ƒç”¨Pythonè§£é‡Šå™¨å¯¹Pythonä»£ç è¿›è¡Œæ‰§è¡Œï¼Œå¹¶é€šè¿‡æ•°æ®ä¸åŸç”Ÿç«¯è¿›è¡Œäº¤äº’ï¼Œç¼–ç å¦‚ä¸‹ï¼š</p>
<p>PythonRun.h:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"BrdgeDefine.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_BEGIN</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">PythonRun</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">INTERFACE_INSTANCE</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) PyObject *mainItemDic;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSDictionary</span> *)run:(<span class="keyword">const</span> <span class="keyword">char</span> *)item method:(<span class="keyword">const</span> <span class="keyword">char</span> *)method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_END</span></span><br></pre></td></tr></table></figure>
<p>PythonRun.m:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"PythonRun.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">PythonRun</span></span></span><br><span class="line"></span><br><span class="line">IMPLEMENTATION_INSTANCE</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSDictionary</span> *)run:(<span class="keyword">const</span> <span class="keyword">char</span> *)item method:(<span class="keyword">const</span> <span class="keyword">char</span> *)method &#123;</span><br><span class="line">    PyObject* pClassCalc = PyDict_GetItemString(<span class="keyword">self</span>.mainItemDic,item);</span><br><span class="line">    PyObject* pInstanceCalc = PyInstanceMethod_New(pClassCalc);</span><br><span class="line">    PyObject* pRet = PyObject_CallMethod(pClassCalc, method, <span class="string">"O"</span>, pInstanceCalc);</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span> dumpInfo:pRet];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSDictionary</span> *)dumpInfo:(PyObject *)pRet &#123;</span><br><span class="line">    <span class="comment">// è§£ææ•°æ®</span></span><br><span class="line">    <span class="keyword">char</span> * resultCString = <span class="literal">NULL</span>;</span><br><span class="line">    PyArg_Parse(pRet, <span class="string">"s"</span>, &amp;resultCString);</span><br><span class="line">    <span class="comment">//å°†pythonç±»å‹çš„è¿”å›å€¼è½¬æ¢ä¸ºc</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span> dumpString:resultCString];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSDictionary</span> *)dumpString:(<span class="keyword">const</span> <span class="keyword">char</span> *)resultCString &#123;</span><br><span class="line">    <span class="built_in">NSString</span> *jsonString = [<span class="built_in">NSString</span> stringWithCString:resultCString encoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    <span class="built_in">NSDictionary</span> *info = [<span class="built_in">NSJSONSerialization</span> JSONObjectWithData:[jsonString dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>] options:<span class="built_in">NSJSONReadingMutableContainers</span> error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSMutableDictionary</span> *dic = [<span class="built_in">NSMutableDictionary</span> dictionaryWithDictionary:info];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSString</span> *k <span class="keyword">in</span> dic.allKeys) &#123;</span><br><span class="line">        <span class="keyword">if</span> ([k isEqualToString:<span class="string">@"subViews"</span>]) &#123;</span><br><span class="line">            <span class="built_in">NSMutableArray</span> *array = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">NSUInteger</span> i = <span class="number">0</span>; i &lt; [dic[k] count]; i++) &#123;</span><br><span class="line">                  [array addObject:[<span class="keyword">self</span> dumpString:[dic[k][i] UTF8String]]];</span><br><span class="line">            &#125;</span><br><span class="line">            dic[k] = [array <span class="keyword">copy</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"dumpInfoâ„ï¸:%@"</span>, dic);</span><br><span class="line">    <span class="keyword">return</span> [dic <span class="keyword">copy</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>é€šè¿‡ä¸Šé¢3ä¸ªæ ¸å¿ƒç±»ï¼Œä¸€ä¸ªç®€æ˜“çš„Pythonå¼•æ“å°±å®Œæ•´äº†ï¼Œä¸‹é¢è¿˜éœ€è¦ç¼–å†™å‡ ä¸ªè½¬æ¢ç±»ï¼Œç”¨æ¥å°†Pythonå¯¹è±¡è½¬æ¢æˆObjective-Cçš„å¯¹è±¡ï¼Œç¼–å†™BridgeColorç±»å¦‚ä¸‹ï¼š</p>
<p>BridgeColor.h:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_BEGIN</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BridgeColor</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">UIColor</span> *)colorWith:(<span class="built_in">NSString</span> *)c;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_END</span></span><br></pre></td></tr></table></figure>
<p>BridgeColor.m:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"BridgeColor.h"</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">BridgeColor</span></span></span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">UIColor</span> *)colorWith:(<span class="built_in">NSString</span> *)c &#123;</span><br><span class="line">    <span class="keyword">if</span> ([c isEqualToString:<span class="string">@"red"</span>]) &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">UIColor</span> redColor];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ([c isEqualToString:<span class="string">@"white"</span>]) &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">UIColor</span> whiteColor];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ([c isEqualToString:<span class="string">@"purple"</span>]) &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">UIColor</span> purpleColor];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">UIColor</span> clearColor];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>BridgeLabel.h:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_BEGIN</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BridgeLabel</span> : <span class="title">UILabel</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSNumber</span> *left;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSNumber</span> *top;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSNumber</span> *width;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSNumber</span> *height;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSNumber</span> *font_size;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *background_color;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *t;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *color;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_END</span></span><br></pre></td></tr></table></figure>
<p>BridgeLabel.m:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"BridgeLabel.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"BridgeColor.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">BridgeLabel</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setLeft:(<span class="built_in">NSNumber</span> *)left &#123;</span><br><span class="line">    _left = left;</span><br><span class="line">    <span class="keyword">self</span>.frame = <span class="built_in">CGRectMake</span>(left.floatValue, <span class="keyword">self</span>.frame.origin.y, <span class="keyword">self</span>.frame.size.width, <span class="keyword">self</span>.frame.size.height);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setTop:(<span class="built_in">NSNumber</span> *)top &#123;</span><br><span class="line">    _top = top;</span><br><span class="line">    <span class="keyword">self</span>.frame = <span class="built_in">CGRectMake</span>(<span class="keyword">self</span>.frame.origin.x, top.floatValue, <span class="keyword">self</span>.frame.size.width, <span class="keyword">self</span>.frame.size.height);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setWidth:(<span class="built_in">NSNumber</span> *)width &#123;</span><br><span class="line">    _width = width;</span><br><span class="line">    <span class="keyword">self</span>.frame = <span class="built_in">CGRectMake</span>(<span class="keyword">self</span>.frame.origin.x, <span class="keyword">self</span>.frame.origin.y, width.floatValue, <span class="keyword">self</span>.frame.size.height);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setHeight:(<span class="built_in">NSNumber</span> *)height &#123;</span><br><span class="line">    _height = height;</span><br><span class="line">    <span class="keyword">self</span>.frame = <span class="built_in">CGRectMake</span>(<span class="keyword">self</span>.frame.origin.x, <span class="keyword">self</span>.frame.origin.y, <span class="keyword">self</span>.frame.size.width, height.floatValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setColor:(<span class="built_in">NSString</span> *)color &#123;</span><br><span class="line">    _color = color;</span><br><span class="line">    <span class="keyword">self</span>.textColor = [BridgeColor colorWith:color];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setT:(<span class="built_in">NSString</span> *)t &#123;</span><br><span class="line">    _t = t;</span><br><span class="line">    <span class="keyword">self</span>.text = t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setFont_size:(<span class="built_in">NSNumber</span> *)font_size &#123;</span><br><span class="line">    _font_size = font_size;</span><br><span class="line">    <span class="keyword">self</span>.font = [<span class="built_in">UIFont</span> systemFontOfSize:font_size.intValue];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setBackground_color:(<span class="built_in">NSString</span> *)background_color &#123;</span><br><span class="line">    _background_color = background_color;</span><br><span class="line">    <span class="keyword">self</span>.backgroundColor = [BridgeColor colorWith:background_color];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>ViewMaker.h:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_BEGIN</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewMaker</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">id</span>)makerView:(<span class="built_in">NSString</span> *)name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_END</span></span><br></pre></td></tr></table></figure>
<p>ViewMaker.m:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"ViewMaker.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"BridgeLabel.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewMaker</span></span></span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">id</span>)makerView:(<span class="built_in">NSString</span> *)name &#123;</span><br><span class="line">    <span class="keyword">if</span> ([name isEqualToString:<span class="string">@"Label"</span>]) &#123;</span><br><span class="line">        <span class="keyword">return</span> [[BridgeLabel alloc] init];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h2 id="å››ã€ç¼–å†™Pythonä¸šåŠ¡ä»£ç "><a href="#å››ã€ç¼–å†™Pythonä¸šåŠ¡ä»£ç " class="headerlink" title="å››ã€ç¼–å†™Pythonä¸šåŠ¡ä»£ç "></a>å››ã€ç¼–å†™Pythonä¸šåŠ¡ä»£ç </h2><pre><code>åœ¨é¡¹ç›®ä¸­æ·»åŠ ä¸¤ä¸ªPythonæ–‡ä»¶ï¼Œä¸€ä¸ªå‘½åä¸ºmain.pyä½œä¸ºåº”ç”¨ç¨‹åºçš„å…¥å£æ–‡ä»¶ï¼Œä¸€ä¸ªå‘½åä¸ºlabel.pyä½œä¸ºæ ‡ç­¾ç»„ä»¶ï¼Œmain.pyæ–‡ä»¶ç¼–å†™ä»£ç å¦‚ä¸‹ï¼š
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> label <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">application_Launch</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">render_main_view</span><span class="params">(self)</span>:</span></span><br><span class="line">        l = Label(<span class="string">"HelloWorld"</span>)</span><br><span class="line">        l.color = <span class="string">"red"</span></span><br><span class="line">        l.font_size = <span class="number">21</span></span><br><span class="line">        l.background_color = <span class="string">"white"</span></span><br><span class="line">        l.left = <span class="number">100</span></span><br><span class="line">        l.top = <span class="number">100</span></span><br><span class="line">        l.width = <span class="number">200</span></span><br><span class="line">        l.height = <span class="number">30</span></span><br><span class="line">        </span><br><span class="line">        l2 = Label(<span class="string">"hhahha"</span>)</span><br><span class="line">        l2.color = <span class="string">"red"</span></span><br><span class="line">        l2.font_size = <span class="number">21</span></span><br><span class="line">        l2.background_color = <span class="string">"white"</span></span><br><span class="line">        l2.left = <span class="number">100</span></span><br><span class="line">        l2.top = <span class="number">300</span></span><br><span class="line">        l2.width = <span class="number">200</span></span><br><span class="line">        l2.height = <span class="number">30</span></span><br><span class="line">        <span class="keyword">return</span> json.dumps(&#123;</span><br><span class="line">            <span class="string">"color"</span>: <span class="string">"purple"</span>,</span><br><span class="line">            <span class="string">"subViews"</span>: [l.render(), l2.render()]</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>
<p>label.pyç¼–å†™ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Label</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, text)</span>:</span></span><br><span class="line">        self.t = text</span><br><span class="line">        self.color = <span class="string">""</span></span><br><span class="line">        self.left = <span class="number">0</span></span><br><span class="line">        self.top = <span class="number">0</span></span><br><span class="line">        self.width = <span class="number">0</span></span><br><span class="line">        self.height = <span class="number">0</span></span><br><span class="line">        self.font_size = <span class="number">0</span></span><br><span class="line">        self.background_color = <span class="string">""</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">render</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> json.dumps(&#123;</span><br><span class="line">            <span class="string">"name"</span>: <span class="string">"Label"</span>,</span><br><span class="line">            <span class="string">"t"</span>: self.t,</span><br><span class="line">            <span class="string">"color"</span>: self.color,</span><br><span class="line">            <span class="string">"left"</span>: self.left,</span><br><span class="line">            <span class="string">"top"</span>: self.top,</span><br><span class="line">            <span class="string">"width"</span>: self.width,</span><br><span class="line">            <span class="string">"height"</span>: self.height,</span><br><span class="line">            <span class="string">"font_size"</span>: self.font_size,</span><br><span class="line">            <span class="string">"background_color"</span>: self.background_color</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>
<p>åˆ°æ­¤ï¼Œä¸€ä¸ªç®€æ˜“çš„Python iOSåº”ç”¨Demoå·¥ç¨‹å°±æ­å»ºå®Œæˆäº†ï¼Œä¸Šé¢ä»£ç åˆ›å»ºäº†ä¸¤ä¸ªæ–‡æœ¬æ ‡ç­¾åœ¨é¡µé¢ä¸Šï¼Œå¹¶å¯¹ç»„ä»¶çš„éƒ¨åˆ†å±æ€§è¿›è¡Œäº†é…ç½®ï¼Œä¸Šé¢å®ç°çš„æ¯ä¸ªç±»éƒ½éå¸¸ç®€å•ï¼Œä½œä¸ºæ€è·¯çš„æ¼”ç¤ºï¼Œåç»­æœ‰æ—¶é—´ä¼šç»§ç»­è¡¥å……å®Œå–„ï¼Œå¹¶é€šè¿‡åšå®¢è¿›è¡Œè¿è½½ä»‹ç»ï¼Œä¸Šé¢å·¥ç¨‹çš„è¿è¡Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://oscimg.oschina.net/oscnet/up-098fd329db2d64df1f9f8dc9945e0b2f8bd.png" alt></p>
<h2 id="äº”ã€åç»­è®¾æƒ³"><a href="#äº”ã€åç»­è®¾æƒ³" class="headerlink" title="äº”ã€åç»­è®¾æƒ³"></a>äº”ã€åç»­è®¾æƒ³</h2><ol>
<li>é€šè¿‡DisplayLinkæ¥è¿›è¡Œé¡µé¢çš„å˜æ›´åˆ·æ–°ï¼Œä¸ºç»„ä»¶å¢åŠ IDï¼Œè®¾è®¡ä¸€ç§ç®—æ³•æ¥å®ç°é«˜æ•ˆçš„é¡µé¢åˆ·æ–°ã€‚</li>
<li>å°†ç»„ä»¶çš„åŠŸèƒ½å®Œå–„ï¼Œæ·»åŠ æ›´å¤šåŸç”Ÿç»„ä»¶çš„æ”¯æŒã€‚</li>
<li>å°†äº‹ä»¶è¿›è¡ŒåŒ…è£…ï¼Œå®šä¹‰å›è°ƒå‡½æ•°ï¼Œè®©Pythonç«¯æœ‰ç”¨å¤„ç†äº‹ä»¶çš„èƒ½åŠ›ã€‚</li>
<li>å¢åŠ æ›´å¤šå·¥å…·æ¥å£ï¼Œå¦‚ç½‘ç»œï¼Œæ•°æ®æ–‡ä»¶æ“ä½œç­‰ã€‚</li>
</ol>
<p>æœ¬ç¯‡åšå®¢å†…å®¹æ¯”è¾ƒç¼©ç•¥ï¼Œä½ å¯ä»¥åœ¨å¦‚ä¸‹åœ°å€æ‰¾åˆ°å®Œæ•´çš„Demoå·¥ç¨‹ï¼š</p>
<p><a href="https://github.com/ZYHshao/PyNativeDemo/tree/master/PyNativeDemo" target="_blank" rel="noopener">https://github.com/ZYHshao/PyNativeDemo/tree/master/PyNativeDemo</a></p>
<p>éœ€è¦æ³¨æ„ï¼Œå·¥ç¨‹è¾ƒå¤§ï¼ŒåŸå› æ˜¯æˆ‘å°†Pythonåº“ä¹Ÿæ”¾äº†è¿›å»ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ä½ ä¸‹è½½çš„ä»£ç æ˜¯å¯è¿è¡Œçš„ã€‚</p>

    </div>

    <div class="post-footer">
        <div>
            
                è½¬è½½å£°æ˜ï¼šå•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒ,éå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ Â© å¾®ä¿¡ï¼š15137348047
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/2020/05/12/400iOSå½•å±æ¡†æ¶ReplayKitçš„åº”ç”¨æ€»ç»“/" class="pre-post btn btn-default" title='iOSå½•å±æ¡†æ¶ReplayKitçš„åº”ç”¨æ€»ç»“'>
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">ä¸Šä¸€ç¯‡</span>
            <span class="hidden-xs">iOSå½•å±æ¡†æ¶ReplayKitçš„åº”ç”¨æ€»ç»“</span>
        </a>
    
    
        <a href="/2020/04/27/398å±æ€§â€œ__attribute__â€åœ¨Objective-Cä¸­çš„åº”ç”¨/" class="next-post btn btn-default" title='å±æ€§â€œ__attribute__â€åœ¨Objective-Cä¸­çš„åº”ç”¨'>
            <span class="hidden-lg">ä¸‹ä¸€ç¯‡</span>
            <span class="hidden-xs">å±æ€§â€œ__attribute__â€åœ¨Objective-Cä¸­çš„åº”ç”¨</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	
<div id="lv-container" data-id="city" data-uid="MTAyMC8zNzY0Ny8xNDE3OA==">
  <script type="text/javascript">
     (function(d, s) {
         var j, e = d.getElementsByTagName(s)[0];
         if (typeof LivereTower === 'function') { return; }
         j = d.createElement(s);
         j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
         j.async = true;
         e.parentNode.insertBefore(j, e);
     })(document, 'script');
  </script>
</div>


    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">æ–‡ç« ç›®å½•</h3>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ä½¿ç”¨Pythonç¼–å†™iOSåŸç”Ÿåº”ç”¨çš„æ¡†æ¶è®¾è®¡æ€è€ƒ-é¦–ç¯‡"><span class="toc-text">ä½¿ç”¨Pythonç¼–å†™iOSåŸç”Ÿåº”ç”¨çš„æ¡†æ¶è®¾è®¡æ€è€ƒ(é¦–ç¯‡)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸€ã€å¼•å­"><span class="toc-text">ä¸€ã€å¼•å­</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#äºŒã€åœ¨iOSå¹³å°ä½¿ç”¨Pythonè§£é‡Šå™¨"><span class="toc-text">äºŒã€åœ¨iOSå¹³å°ä½¿ç”¨Pythonè§£é‡Šå™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸‰ã€ç¼–å†™æ¡¥æ¥æ–‡ä»¶"><span class="toc-text">ä¸‰ã€ç¼–å†™æ¡¥æ¥æ–‡ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å››ã€ç¼–å†™Pythonä¸šåŠ¡ä»£ç "><span class="toc-text">å››ã€ç¼–å†™Pythonä¸šåŠ¡ä»£ç </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#äº”ã€åç»­è®¾æƒ³"><span class="toc-text">äº”ã€åç»­è®¾æƒ³</span></a></li></ol></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12"> 
                <span>Copyright &copy; 2018
                </span> | 
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> | 
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>



<script src="/js/app.js?rev=@@hash"></script>


</body>
</html>